<!-- choose-plan-dialog.component.html -->
<h2 mat-dialog-title>
  Choose Your Plan
  <button mat-icon-button mat-dialog-close class="close-button">
    <mat-icon>close</mat-icon>
  </button>
</h2>

<mat-dialog-content>
  <div class="plans-container">
    @for (plan of plans; track plan.id) {
      <mat-card [class.highlighted]="plan.highlighted" [class.current-plan]="plan.currentPlan">
        @if (plan.currentPlan) {
          <div class="current-plan-badge">
            <mat-chip>
              <mat-icon matChipTrailingIcon>check_circle</mat-icon>
              Current Plan
            </mat-chip>
          </div>
        }

        <mat-card-header>
          <mat-card-title>{{ plan.name }}</mat-card-title>
          <mat-card-subtitle>{{ plan.storage }} Storage</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
          <div class="price-section">
            <span class="currency">$</span>
            <span class="amount">{{ plan.price }}</span>
            @if (plan.period) {
              <span class="period">/{{ plan.period }}</span>
            }
          </div>

          <mat-list class="features-list">
            @for (feature of plan.features; track feature.text) {
              <mat-list-item [class.not-included]="!feature.included">
                <mat-icon matListItemIcon>
                  {{ feature.included ? 'check_circle' : 'cancel' }}
                </mat-icon>
                <span matListItemTitle>{{ feature.text }}</span>
              </mat-list-item>
            }
          </mat-list>
        </mat-card-content>

        <mat-card-actions>
          @if (plan.currentPlan) {
            <button mat-stroked-button disabled>
              Current Plan
            </button>
          } @else {
            <button 
              mat-flat-button 
              [color]="plan.highlighted ? 'primary' : 'accent'"
              (click)="selectPlan(plan)">
              {{ plan.id === 'FREE' ? 'Downgrade' : 'Upgrade' }} to {{ plan.name }}
            </button>
          }
        </mat-card-actions>
      </mat-card>
    }
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Cancel</button>
</mat-dialog-actions>